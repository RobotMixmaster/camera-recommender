<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Camera Recommender</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <div class="max-w-5xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-4">ğŸ“· ì¹´ë©”ë¼ ì¶”ì²œ ì‹œìŠ¤í…œ</h1>

    <!-- í•„í„° ì„¹ì…˜ -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
      <div>
        <label class="block mb-1">ì˜ˆì‚° (ë§Œì›)</label>
        <input id="budgetInput" type="number" min="0" max="1000" placeholder="ì˜ˆ: 150" class="w-full p-2 border rounded" />
      </div>
      <div>
        <label class="block mb-1">ì„¼ì„œ í¬ê¸°</label>
        <select id="sensorFilter" class="w-full p-2 border rounded">
          <option value="">ì „ì²´</option>
          <option value="APS-C">APS-C</option>
          <option value="Full frame">Full frame</option>
        </select>
      </div>
      <div>
        <label class="block mb-1">RAW ì§€ì›</label>
        <select id="rawFilter" class="w-full p-2 border rounded">
          <option value="">ì „ì²´</option>
          <option value="true">ì§€ì›</option>
          <option value="false">ë¹„ì§€ì›</option>
        </select>
      </div>
      <div>
        <label class="block mb-1">ì •ë ¬ ê¸°ì¤€</label>
        <select id="sortOption" class="w-full p-2 border rounded">
          <option value="price">ê°€ê²©ìˆœ</option>
          <option value="weight">ë¬´ê²Œìˆœ</option>
        </select>
      </div>
    </div>

    <button onclick="filterCameras()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded mb-6">ì¶”ì²œë°›ê¸°</button>

    <!-- ê²°ê³¼ ì¶œë ¥ -->
    <div id="results" class="grid grid-cols-1 gap-4"></div>
  </div>

  <script>
    let cameraData = [];

    async function loadCameras() {
      const res = await fetch('./db/cameras.json');
      cameraData = await res.json();
      filterCameras();
    }

    function filterCameras() {
      const budget = parseInt(document.getElementById('budgetInput').value) * 10000 || Infinity;
      const sensor = document.getElementById('sensorFilter').value;
      const raw = document.getElementById('rawFilter').value;
      const sort = document.getElementById('sortOption').value;

      let filtered = cameraData.filter(cam => {
        return (!sensor || cam.sensor === sensor) &&
               (raw === '' || cam.raw.toString() === raw) &&
               (!cam.price || cam.price <= budget);
      });

      if (sort === 'price') {
        filtered.sort((a, b) => (a.price || Infinity) - (b.price || Infinity));
      } else if (sort === 'weight') {
        filtered.sort((a, b) => (a.weight || Infinity) - (b.weight || Infinity));
      }

      displayResults(filtered);
    }

    function displayResults(cameras) {
      const container = document.getElementById('results');
      container.innerHTML = '';
      if (cameras.length === 0) {
        container.innerHTML = '<p class="text-gray-500">ì¡°ê±´ì— ë§ëŠ” ì¹´ë©”ë¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
        return;
      }

      cameras.forEach(cam => {
        const card = document.createElement('div');
        card.className = 'border p-4 rounded shadow bg-white';
        card.innerHTML = `
          <h2 class="text-xl font-bold mb-2">${cam.name}</h2>
          <ul class="text-sm text-gray-700 space-y-1">
            <li><strong>ì„¼ì„œ:</strong> ${cam.sensor || 'ì •ë³´ ì—†ìŒ'}</li>
            <li><strong>RAW:</strong> ${cam.raw ? 'ì§€ì›' : 'ë¹„ì§€ì›'}</li>
            <li><strong>ë¬´ê²Œ:</strong> ${cam.weight ? cam.weight + 'g' : 'ì •ë³´ ì—†ìŒ'}</li>
            <li><strong>ê°€ê²©:</strong> ${cam.price ? cam.price.toLocaleString() + 'ì›' : 'ì •ë³´ ì—†ìŒ'}</li>
            <li><strong>ìœ í˜•:</strong> ${cam.type || 'ê¸°íƒ€'}</li>
          </ul>
        `;
        container.appendChild(card);
      });
    }

    window.onload = loadCameras;
  </script>
</body>
</html>